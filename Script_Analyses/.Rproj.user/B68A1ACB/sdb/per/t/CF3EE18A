{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Evolution of Stress response in Aphaenogaster\"\nauthor: \"Andrew Nguyen\"\ndate: \"2015-August-25\"\noutput: pdf_document\n---\n\n#How does the stress response evolve in organisms(ants) that experience varying thermal environments?\n\nHypothesis: Ants elicit the stress response that match their local thermal environments, indicative of local adaptation.\n\nPrediction: There should be clinal variation in the stress response across A. picea/rudis'.\n\nMethods: We collected along a N-S transect from Florida to Maine and measured their stress response under a common garden experiment. In total, we sampled 27 unique sites and collected 74 colonies. To determine whetherWe measured the stress response quantifying the basal and induction gene expression patterns of three heat shock proteins (hsc70, hsp83, hsp40) for each colony. The degree of induction was measured as the relative fold increase of mildly heat treated (37C) compared to control treated(25C) ants. \n\nIn total, there were 64 colonies, 37 of which reared at 20C and 27 reared at 26C.\n\n###20150824 update: Including phylogenetic relationships into regressions\n\n###20150825 meeting: use forward selection with AIC instead of model averaging; Bible(primer of ecological statistics) pg 346\n\n###20150826 update: identified error(wrong CT value) for hsp70 basal xp in sample 5-B.\n\n```{r load libraries, echo=FALSE,include=FALSE}\nlibrary(plyr)\nlibrary(dplyr)\nlibrary(MuMIn)\noptions(na.action = \"na.fail\")\nlibrary(ape)\nlibrary(MASS)\nlibrary(ggplot2)\nlibrary(gridExtra)\nlibrary(raster)\nlibrary(rgdal) \nlibrary(dismo)\nlibrary(maptools)\nlibrary(mapdata)\n```\n#Data parsing\n```{r data parsing}\ndat<-read.csv(\"../Data/20150810_anbe_curated_dat_v3.csv\",skip=6) #xp data\ndat2<-read.csv(\"../Data/2015_JSG_phytotron_bioclim.csv\") # full data set with climate factors\n#changing factors into characters for Colony so I can merg em!\ndat$Colony<-as.factor(as.character(dat$Colony))\ndat2$Colony<-as.factor(as.character(dat2$Colony))\n\n#merging dat and dat2 so I can link up xp data with climate factors!\nmerg<-inner_join(dat2,dat,by=\"Colony\")\n#summary of data\ndim(merg) # dimensions of dataset\nsummary(merg$Species_2)# number of species\n\nsummary(as.factor(as.character(merg$Rearing_Temp)))#the number of colonies reared at 20 and 26\nknitr::kable(subset(merg,merg$Species_2==\"fulva\")[,1:14] )# just seeing what fulva looks like\n\n#reading in phylogenetic tree \n#jsg.tree<-read.tree(\"../Phylogenetics/20150824_JSG_phytotron_tree_BL_only_v2\")\njsg.tree<-read.tree(\"../Data/Phylogenetics/20150824_JSG_phytotron_tree_BL_only_v2\")\n#\"28-A\"\njsg.tree<-drop.tip(jsg.tree,tip=c(\"28-A\",\"11-C\",\"25-C\",\"07-B\",\"10-F\"))\nplot(jsg.tree)\nwrite.tree(jsg.tree,\"20161012_Hsp_modulation_phylogeny.newick\")\n#newblife<-read.tree(\"Phylogenetics/20150824_JSG_phytotron_tree_BL_only_v3_20150219_renamed_pub_fig_noBR1_v2\")\n#newblife2<-drop.tip(newblife,tip=c(\"BR1\"))\n#plot(newblife2)\n#write.tree(newblife2,\"20150824_JSG_phytotron_tree_BL_only_v3_20150219_renamed_pub_fig_noBR1_v3\")\n#length(newblife2$tip.label);length(newblife2$tip.label)\npcoa.jsg<-pcoa(cophenetic.phylo(jsg.tree))\nbiplot(pcoa.jsg) #viewing separation \n\n#setting as dataframe\nn.pcoa.jsg<-as.data.frame(pcoa.jsg$vectors[,1:4])\nn.pcoa.jsg$Colony<-jsg.tree$tip.label\ndim(n.pcoa.jsg)\n##making full dataset\nmerg<-inner_join(merg,n.pcoa.jsg,by=\"Colony\")\nnames(merg)\nnames(merg)[44:46]<-c(\"Axis.1\",\"Axis.2\",\"Axis.3\")\ndim(merg)# nice!!\nsummary(as.factor(as.character(merg$Rearing_Temp)))\nful<-subset(merg,merg$Species_2==\"fulva\")\n\nddply(merg,.(Site),summarize,count=length(Colony))#counts of colonies at each site\nplot(merg$Axis.1,merg$Axis.2,xlim=c(-.15,.25),ylim=c(-.25,.1),type=\"n\",xlab=\"Axis 1\",ylab=\"Axis 2\")\ntext(merg$Axis.1,merg$Axis.2,labels=merg$Tree_site)\n\nplot(merg$Axis.2,merg$Axis.3,type=\"n\",xlab=\"Axis 2\",ylab=\"Axis 3\",xlim=c(-.05,.1))\ntext(merg$Axis.2,merg$Axis.3,labels=merg$Tree_site)\n\n```\n\n#checking axes\n```{r checking axes}\n#phylo.70.1<-lm(log10(merg$FC_70)~merg$Axis.1)\n#hist(resid(phylo.70.1),xlim=c(-.8,.8))\n\n\nphylo.70.2<-lm(log10(merg$FC_70)~merg$Axis.1+merg$Axis.2)\nhist(resid(phylo.70.2),xlim=c(-.8,.8))\n\nphylo.70.3<-lm(log10(merg$FC_70)~merg$Axis.1+merg$Axis.2+merg$Axis.3)\nhist(resid(phylo.70.3))\n\n```\n\n#Stats: Using forward selection\nresponse: basal or induction gene xp--log10 transformed to meet the assumptions of normality\npredictors: rearing temp, Tmax(bio5)\n```{r forward model selection}\n#applying a regression model across columns\n#response: basal or induction gene xp\n#predictors: rearing temp, bio1(MAT)\nmergy<-merg[-57,]\n\n##induction\n#hsp70 induction\nfull.70<-lm(log10(merg$FC_70)~merg$bio5+merg$Rearing_Temp+merg$Axis.1+merg$Axis.2+merg$Axis.3)\nsummary(stepAIC(full.70,direction=\"forward\"))\nboxplot(log10(FC_70)~Rearing_Temp,data=merg)\n#hsp83 induction\nfull.83<-lm(log10(merg$FC_83)~merg$bio5+merg$Rearing_Temp+merg$Axis.1+merg$Axis.2+merg$Axis.3)\nsummary(stepAIC(full.83,direction=\"forward\"))\ngg<-dredge(full.83)\nboxplot(FC_83~Rearing_Temp,data=merg)\n#write.csv(subset(merg,merg$FC_83>10),\"test.csv\")\n#hsp40 induction\nfull.40<-lm(log10(mergy$FC_40)~mergy$bio5+mergy$Rearing_Temp+mergy$Axis.1+mergy$Axis.2+mergy$Axis.3)\nsummary(stepAIC(full.40,direction=\"forward\"))\n#aov_40_induction<-aov(log10(mergy$FC_40)~mergy$Rearing_Temp)\n#summary(aov_40_induction)\n#plot(aov_40_induction)\n\n#looks good\n\n#removing influental sample # 48\n#out_48_for_hsp40<-mergy[-48,]\n#sub_40<-lm(log10(out_48_for_hsp40$FC_40)~out_48_for_hsp40$bio5+out_48_for_hsp40$Rearing_Temp+out_48_for_hsp40$Axis.1+out_48_for_hsp40$Axis.2+out_48_for_hsp40$Axis.3)\n#summary(stepAIC(sub_40,direction=\"forward\"))\n\n########################\n\n#basal\n#hsp70\nB.70<-lm(log10(merg$B_70)~merg$bio5+merg$Rearing_Temp+merg$Axis.1+merg$Axis.2+merg$Axis.3)\nsummary(stepAIC(B.70,direction=\"forward\"))\nboxplot(log10(merg$B_70)~merg$Rearing_Temp,ylab=\"log10 transformed fold change\",las=1,xlab=\"rearing temp\")\n\n########################\npar(mfrow=c(2,2))\nplot(B.70)\npar(mfrow=c(1,1))\n#hsp83\nB.83<-lm(log10(merg$B_83)~merg$bio5+merg$Rearing_Temp+merg$Axis.1+merg$Axis.2+merg$Axis.3)\nsummary(stepAIC(B.83,direction=\"forward\"))\n#boxplot(log10(merg$B_83)~merg$Rearing_Temp) #doesn't look real\n#hsp40\n\nB.40<-lm(log10(B_40)~bio5+Rearing_Temp+Axis.1+Axis.2+Axis.3,data=merg)\nsummary(stepAIC(B.40,direction=\"forward\"))\n\n####two panel figurse for hsp70 basal and hsp40 induction!\n#side by side plot\n#grid.arrange(basal_70,induc_hsp40,ncol=2)\n#stacked plot\n#new_hsp70<-basal_70+xlab(\"\")\n#grid.arrange(new_hsp70,induc_hsp40,nrow=2)\n# effect of MAT on hsp gxp\napply(merg[,38:43],2,function(x){summary(stepAIC(lm(log10(x)~merg$bio5+merg$Rearing_Temp+merg$Axis.1+merg$Axis.2+merg$Axis.3)),direction=\"forward\")})\n\n\napply(mergy[,38:43],2,function(x){summary(stepAIC(lm(log10(x)~mergy$bio1+mergy$Rearing_Temp+mergy$Axis.1+mergy$Axis.2+mergy$Axis.3)),direction=\"forward\")})\n\napply(mergy[,38:43],2,function(x){summary(stepAIC(lm(log10(x)~mergy$bio5+mergy$Rearing_Temp+mergy$Axis.2+mergy$Axis.3)),direction=\"forward\")})\n```\n\n#Mean expression values\n```{r mean expression values}\n## overall mean\nknitr::kable(as.data.frame(apply(mergy[,38:43],2,mean)))\n\n\ndim(mergy)\nF<-c(rep(\"FC_83\",56),rep(\"FC_70\",56),rep(\"FC_40\",56))\nnn<-data.frame(cbind(F,c(mergy[,38],mergy[,39],mergy[,40])))\nnn$V2<-as.numeric(as.character(nn$V2))\nsummary(aov(V2~F,data=nn))\n##by rearing temp\nc<-ddply(merg,.(Rearing_Temp),summarize, Induction83=mean(FC_83),Basal83=mean(B_83),Induction70=mean(FC_70),Basal70=mean(B_70))\n\ni<-ddply(mergy,.(Rearing_Temp),summarize,Induction40=mean(FC_40),Basal40=mean(B_40))\n\nda<-cbind(c,i[,2:3])\n\n#table of means\nknitr::kable(da)\n\n\n#median expression\ncc<-ddply(merg,.(Rearing_Temp),summarize, Induction83=median(FC_83),Basal83=median(B_83),Induction70=median(FC_70),Basal70=median(B_70))\n\nii<-ddply(mergy,.(Rearing_Temp),summarize,Induction40=median(FC_40),Basal40=median(B_40))\n#medians\nmedians<-cbind(cc,ii[,2:3])\n```\n\n#Expression Figures for rearing temp\n```{r rearing temp figures}\n#theme########################################\nT<-theme_bw()+theme(text=element_text(size=30),axis.text=element_text(size=30),legend.text=element_text(size=28),panel.grid.major=element_blank(),panel.grid.minor.x = element_blank(),panel.grid = element_blank(),legend.key = element_blank())\n\ndude<-scale_fill_manual(name = \"\", values = c(\"gray\", \"goldenrod\"))\n#color\n##################################################\n#####ggplot of hsp83 basal\n#add notches: geom_boxplot(notch=TRUE)\nbasal_83<-ggplot(data=merg,aes(x=factor(Rearing_Temp),y=B_83,fill=factor(Rearing_Temp)))+geom_boxplot()+T+ylab(expression(paste(\"Hsp83 basal expression (\",2^paste(Delta,Delta,\"CT\"),\")\")))+scale_y_continuous(limits=c(0,7),breaks=seq(0,7,1))+xlab(\"\")+dude+guides(fill=FALSE)\n\n#+xlab(\"Maintenance Temperature (째C)\")\nbasal_83\n\n#####ggplot of hsp70 basal\nbasal_70<-ggplot(data=merg,aes(x=factor(Rearing_Temp),y=B_70,fill=factor(Rearing_Temp)))+geom_boxplot()+T+ylab(expression(paste(\"Hsp70 basal expression (\",2^paste(Delta,Delta,\"CT\"),\")\")))+scale_y_continuous(limits=c(0,8),breaks=seq(0,8,2))+xlab(\"\")+dude+guides(fill=FALSE)\n#+xlab(\"Maintenance Temperature (째C)\")\nbasal_70\n#####ggplot of hsp40 basal\nbasal_40<-ggplot(data=mergy,aes(x=factor(Rearing_Temp),y=B_40,fill=factor(Rearing_Temp)))+geom_boxplot()+ylab(expression(paste(\"Hsp40 basal expression (\",2^paste(Delta,Delta,\"CT\"),\")\")))+scale_y_continuous(limits=c(0,11),breaks=seq(0,11,1))+T+xlab(\"\")+dude+guides(fill=FALSE)+xlab(\"Acclimation Temperature (째C)\")\n#+xlab(\"Maintenance Temperature (째C)\")+\nbasal_40\n\n#####ggplot of hsp83 induction\ninduc_hsp83<-ggplot(data=merg,aes(x=factor(Rearing_Temp),y=FC_83,fill=factor(Rearing_Temp)))+geom_boxplot()+T+xlab(\"\")+ylab(expression(paste(\"Hsp83 induction (\",2^paste(Delta,Delta,\"CT\"),\")\")))+dude+guides(fill=FALSE)\ninduc_hsp83\n\n#####ggplot of hsp70 induction\ninduc_hsp70<-ggplot(data=merg,aes(x=factor(Rearing_Temp),y=FC_70,fill=factor(Rearing_Temp)))+geom_boxplot()+T+xlab(\"\")+ylab(expression(paste(\"Hsp70 induction (\",2^paste(Delta,Delta,\"CT\"),\")\")))+dude+guides(fill=FALSE)\ninduc_hsp70\n#####ggplot of hsp70 induction\n#####ggplot of hsp40 induction\ninduc_hsp40<-ggplot(data=mergy,aes(x=factor(Rearing_Temp),y=FC_40,fill=factor(Rearing_Temp)))+geom_boxplot()+T+xlab(\"Acclimation Temperature (째C)\")+ylab(expression(paste(\"Hsp40 induction (\",2^paste(Delta,Delta,\"CT\"),\")\")))+T+dude+guides(fill=FALSE)\ninduc_hsp40\n#+scale_y_continuous(limits=c(0,8),breaks=seq(0,8,2))\n\n\n#grid.arrange(basal_83,basal_70,basal_40,induc_hsp83,induc_hsp70,induc_hsp40,nrow=2,ncol=3)\n\ngrid.arrange(basal_83,induc_hsp83,basal_70,induc_hsp70,basal_40,induc_hsp40,nrow=3,ncol=2)\n\n```\n#Expression figures against Tmax\n```{r expression figs against Tmax}\nT<-theme_bw()+theme(text=element_text(size=30),axis.text=element_text(size=30),legend.text=element_text(size=28),panel.grid.major=element_blank(),legend.position=\"none\",panel.grid.minor.x = element_blank(),panel.grid = element_blank(),legend.key = element_blank())\n#loess fit\n#loess<-stat_smooth(colour=\"red\",geom=\"smooth\",method=\"auto\",se=FALSE,size=3)\nloess<-stat_smooth(colour=\"red\",method=\"loess\",span=1)\n#merg$bio5<-merg$bio5/10\n\n######hsp83 basal###############\nT83<-ggplot(data=merg,aes(x=bio5/10,y=B_83))+geom_point(size=5)+T+ylab(expression(paste(\"Hsp83 basal expression (\",2^paste(\"-\",Delta,Delta,\"CT\"),\")\")))+scale_y_continuous(limits=c(0,7),breaks=seq(0,7,1))+xlab(\"\")\n#+loess\nT83\n\n######hsp70 basal###############\nT70<-ggplot(data=merg,aes(x=bio5/10,y=B_70))+geom_point(size=5)+T+ylab(expression(paste(\"Hsp70 basal expression (\",2^paste(\"-\",Delta,Delta,\"CT\"),\")\")))+scale_y_continuous(limits=c(0,7),breaks=seq(0,7,1))+xlab(\"\")\n#+loess\nT70\n\n######hsp40 basal###############\n#mergy$bio5<-mergy$bio5/10\nT40<-ggplot(data=mergy,aes(x=bio5/10,y=B_40))+geom_point(size=5)+T+ylab(expression(paste(\"Hsp40 basal expression (\",2^paste(\"-\",Delta,Delta,\"CT\"),\")\")))+scale_y_continuous(limits=c(0,11),breaks=seq(0,11,1))+xlab(\"Tmax (째C)\")\n#+loess\nT40\n\n#####################\n######hsp83 induction###############\nT83ind<-ggplot(data=merg,aes(x=bio5/10,y=FC_83))+geom_point(size=5)+T+ylab(expression(paste(\"Hsp83 induction (\",2^paste(\"-\",Delta,Delta,\"CT\"),\")\")))+scale_y_continuous(limits=c(0,44),breaks=seq(0,44,4))+xlab(\"\")\n#+loess\nT83ind\n\n######hsp70 induction###############\nT70ind<-ggplot(data=merg,aes(x=bio5/10,y=FC_70,))+geom_point(size=5)+T+ylab(expression(paste(\"Hsp70 induction (\",2^paste(\"-\",Delta,Delta,\"CT\"),\")\")))+scale_y_continuous(limits=c(10,120),breaks=seq(10,120,10))+xlab(\"\")\n#+loess\nT70ind\n\n######hsp40 induction###############\nT40ind<-ggplot(data=mergy,aes(x=bio5/10,y=FC_40))+geom_point(size=5)+T+ylab(expression(paste(\"Hsp40 induction (\",2^paste(\"-\",Delta,Delta,\"CT\"),\")\")))+scale_y_continuous(limits=c(0,44),breaks=seq(0,44,4))+xlab(\"Tmax (째C)\")\n#+loess\nT40ind\n\n#grid.arrange(T83,T70,T40,T83ind,T70ind,T40ind,nrow=2,ncol=3)\ngrid.arrange(T83,T70,T40,nrow=3)\ngrid.arrange(T83ind,T70ind,T40ind,nrow=3)\n```\n#Hsp40 vs Axis 3\n```{r hsp40 v axis3,eval=FALSE}\nplot(B_40~Axis.3,data=mergy)\ntext(mergy$Axis.3,mergy$B_40,labels=mergy$Colony)\n#t<-mergy\n#hist(mergy$Axis.3)\n#regular zoom\nplot(mergy$Axis.3,mergy$Axis.2,type=\"n\")\ntext(mergy$Axis.3,mergy$Axis.2,labels=mergy$Colony)\n\n#zoomed in\nplot(mergy$Axis.3,mergy$Axis.2,ylim=c(0.02,0.05))\ntext(mergy$Axis.3,mergy$Axis.2,labels=mergy$Colony)\n#data parsing\nmergy<-subset(merg,merg$Axis.2> -0.1)\nsub<-subset(merg,merg$Axis.2< -0.1)\nsub$axis3_desig<-as.factor(rep(\"zAxis 2 A. picea\",3))\nmergy$axis3_desig<-ifelse(mergy$Axis.3<= -0.044,\"North\",ifelse(mergy$Axis.3>0.05,\"South\",\"A. picea\"))\nmergy<-rbind(mergy,sub)\nmergy<-mergy[-54,]\nboxplot(log10(B_40)~axis3_desig,data=mergy)\nsummary(aov(log10(B_40)~axis3_desig,data=mergy))\n\nnewb<-subset(mergy,mergy$axis3_desig==\"South\")\nnewb2<-subset(mergy,mergy$axis3_desig==\"North\")\nnewb3<-as.data.frame(rbind(newb,newb2))\nsummary(aov(log10(B_40)~axis3_desig,data=mergy))\nboxplot(B_40~axis3_desig,data=newb3,las=1,xlab=\"A. rudis clade (Axis 3)\",ylab=\"log10 Hsp40 Basal expression\")\n\n###ggplot fig\nAxis3_b40<-ggplot(data=newb3,aes(x=factor(axis3_desig),y=B_40,fill=factor(axis3_desig)))+geom_boxplot()+T+ylab(expression(paste(\"Hsp40 basal expression (\",2^paste(Delta,Delta,\"CT\"),\")\")))+scale_y_continuous(limits=c(0,7),breaks=seq(0,7,1))+scale_fill_manual(name = \"\", values = c(\"deepskyblue4\", \"firebrick\"))+guides(fill=FALSE)+xlab(expression(paste(italic(\"A. rudis\"),\" clade (Axis 3)\")))\n#+xlab(\"A. rudis clade (Axis 3)\")\nAxis3_b40\n\nmergy$axis3_desig<-as.factor(mergy$axis3_desig)\n###with all 3\nAxis3_b40_v2<-ggplot(data=mergy,aes(x=factor(axis3_desig),y=B_40,color=factor(axis3_desig)))+geom_jitter(position=position_jitter(0.1),cex=6)+T+\n  ylab(expression(paste(\"Hsp40 basal expression (\",2^paste(Delta,Delta,\"CT\"),\")\")))+\n  scale_y_continuous(limits=c(0,7),breaks=seq(0,7,1))+\n  scale_colour_manual(name = \"\", values = c(\"black\",\"deepskyblue4\", \"firebrick\",\"purple\"))+guides(fill=FALSE)+xlab(expression(paste(italic(\"                     A. rudis\"),\" clade (Axis 3)\")))\n#+xlab(\"A. rudis clade (Axis 3)\")\nAxis3_b40_v2\n\n###v3\n\n#grab medians\nmeds <- c(by(mergy$B_40, mergy$axis3_desig, median))\nmeans <- c(by(mergy$B_40, mergy$axis3_desig, mean))\n\nAxis3_b40_v3<-ggplot(data=mergy,aes(x=factor(axis3_desig),y=B_40,fill=factor(axis3_desig)))+geom_boxplot()+T+\n  ylab(expression(paste(\"Hsp40 basal expression (\",2^paste(Delta,Delta,\"CT\"),\")\")))+scale_x_discrete(expression(paste(italic(\"                     A. rudis\"),\" clade\")),labels=expression(paste(italic(\"                                                    A. picea \"),\"            North   \",\"       South \",\"    Axis 2\")))+\n  scale_y_continuous(limits=c(-1,11),breaks=seq(0,11,1))+\n  scale_fill_manual(name = \"\", values = c(\"gray\",\"deepskyblue4\", \"firebrick\",\"purple\"))+guides(fill=FALSE)\nAxis3_b40_v3\n\nboxplot(B_40~axis3_desig,data=mergy)\n```\n#hsp40 vs axis2\n\n```{r hsp40 vs axis2,eval=FALSE}\n#regular zoom\nplot(mergy$Axis.3,mergy$Axis.2,type=\"n\")\ntext(mergy$Axis.3,mergy$Axis.2,labels=mergy$Colony)\n\nmergy$desig_axis2<-ifelse(mergy$Axis.2<= -.1,\"hybrids\",\"picea/rudis\")\n\npar(mar=c(5,5,5,5))\nboxplot(B_40~desig_axis2,data=mergy,ylab=\"hsp40 basal expression\",xlab=\"Axis 2 designations\")#looking\nboxplot(log10(B_40)~desig_axis2,data=mergy,ylab=\"Log10 hsp40 basal expression\",xlab=\"Axis 2 designations\")#looking\n\n\n```\n\n\n#making maps for a talk\n##field collections site map\n```{r,eval=FALSE}\nw <- getData('worldclim', var='bio', res=2.5)\n\nplot(w, 5, xlim=c(-87,-65), ylim=c(30,48), axes=F, legend=T, col=colorRampPalette(c(\"skyblue\",\"white\"))(255),main=\"\",box=FALSE)\n#map(\"world\",c(\"USA\",\"Canada\"),add=TRUE)\nmap(\"state\", c('florida', 'south carolina', 'north carolina', 'georgia', 'virginia', 'west virginia', 'maryland', 'delaware', 'new jersey', 'rhode island', 'new york', 'connecticut', 'massachusetts', 'pennyslvania', 'vermont', 'new hampshire', 'maine', 'alabama', 'tennessee', 'kentucky', 'ohio','iowa','illinois','arkansas','missouri','minnesota','wisconsin','michigan','louisiana','mississippi',\"texas\",\"arizona\",\"illinois\",\"california\",\"oregon\",\"utah\",\"washington\",\"kansas\",\"new mexico\",\"montana\",\"idaho\",\"wyoming\",\"north dakota\",\"south dakota\",\"nebraska\",\"oklahoma\"), add = TRUE)\nrect(-150,25,-55,5,col=\"white\",border=\"white\")\nrect(-65,50,-50,25,col=\"white\",border=\"white\")\nrect(-87,50,-100,25,col=\"white\",border=\"white\")\nbb8<-read.csv(\"../Data/20160219_site_for_map_excludingsome_v2.csv\")\ncolm<-ifelse(merg$Axis.1>.17,\"#D55E00\",\"#0072B2\")\npoints(merg$lon.2,merg$lat,pch=20,col=colm,cex=1.75)\n#points(bb8$lon.2,bb8$lat,pch=20,cex=1.5)\ntext(bb8$lon.3,bb8$lat+.4,labels=bb8$Site_2,cex=.75,font=2)\n#plotting points with the size related to thermal niche breadth\n#add color by species\n#http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/#a-colorblind-friendly-palette\n\n\n\n#text(merg$lon.2,merg$lat+.5,labels=merg$Site_2,cex=.75)\n\n\n\n\n```\n\n\n```{r}\ncpsit<-ddply(merg,.(Site_2),summarize,Longitude=mean(lon.2),Latitude=mean(lat),Tmax=mean(bio5))\nhead(cpsit)\ndim(cpsit)\n\ncpsit\nnew<-cpsit[order(cpsit$Tmax),]\nnew\n\n#write.csv(new,\"Sampling_sites_table.csv\")\n\n```\n\n#20160825_sampling map\n```{r,eval=FALSE}\nfgl<-read.csv(\"20160825_final_dataset_HSP_modulation.csv\")\nfgl$tree_color<-as.character(fgl$tree_color)\n\n\nplot(w, 5, xlim=c(-87,-65), ylim=c(30,48), axes=FALSE, legend=FALSE, col=colorRampPalette(c(\"skyblue\",\"white\"))(255),main=\"\",box=FALSE)\n#map(\"world\",c(\"USA\",\"Canada\"),add=TRUE)\nmap(\"state\", c('florida', 'south carolina', 'north carolina', 'georgia', 'virginia', 'west virginia', 'maryland', 'delaware', 'new jersey', 'rhode island', 'new york', 'connecticut', 'massachusetts', 'pennyslvania', 'vermont', 'new hampshire', 'maine', 'alabama', 'tennessee', 'kentucky', 'ohio','iowa','illinois','arkansas','missouri','minnesota','wisconsin','michigan','louisiana','mississippi',\"texas\",\"arizona\",\"illinois\",\"california\",\"oregon\",\"utah\",\"washington\",\"kansas\",\"new mexico\",\"montana\",\"idaho\",\"wyoming\",\"north dakota\",\"south dakota\",\"nebraska\",\"oklahoma\"), add = TRUE)\nmap('lakes', add=TRUE, fill=TRUE, col='white', boundary='black')\nrect(-150,25,-55,5,col=\"white\",border=\"white\")\nrect(-65,50,-50,25,col=\"white\",border=\"white\")\nrect(-87,50,-100,25,col=\"white\",border=\"white\")\n\npoints(fgl$lon.2,fgl$lat,col=fgl$tree_color,pch=fgl$pch)\n#la<-subset(bb8,bb8$Site==\"LA\")\npoints(-79.181,37.4211,pch=19,col=\"blue\")\n#text(fgl$lon.3,fgl$lat+.4,labels=fgl$Site_2,cex=.75,font=2)\ntext(bb8$lon.3,bb8$lat+.4,labels=bb8$Site_2,cex=.75,font=2)\n\n```\n\n#checking correlation between Tmax, MAT, and Phylogenetic Axes\n```{r}\nnames(mergy)\nknitr::kable(round(cor(cbind(mergy$bio1,mergy$bio5,mergy[,44:47])),3)) \n```\n\n\n#Checking basal ct values\n```{r}\nct<-read.csv(\"../Data/20150810_raw_CT_values.csv\")\n\nz<-inner_join(ct,mergy,by=\"Colony\")\nz$qpcr_block<-as.factor(z$qpcr_block)\n#different 18s ct among treatments?\n#different 18s ct\nsummary(stepAIC(lm(log2(X18)~bio5*treatment+qpcr_block+Axis.1+Axis.2+Axis.3+Rearing_Temp,data=z2)),direction=\"forward\")\n\n\n```\n\n```{r Sessioninfo}\nsessionInfo()\n```\n\n",
    "created" : 1476301374267.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "39|19|89|0|\n92|20|103|0|\n108|30|173|0|\n176|29|203|0|\n293|31|348|0|\n351|32|363|0|\n368|17|393|0|\n396|6|407|0|\n432|6|435|0|\n",
    "hash" : "939517682",
    "id" : "CF3EE18A",
    "lastKnownWriteTime" : 1478203466,
    "last_content_update" : 1478203472454,
    "path" : "~/zScience/Side_projects/2013_Phytotron_JSG_hsp_GXP/Script_Analyses/20150810_Evolution_of_Stress_updated_V4.Rmd",
    "project_path" : "20150810_Evolution_of_Stress_updated_V4.Rmd",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}